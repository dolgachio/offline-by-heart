<!DOCTYPE html>
<html lang="en">
<head>
    <title>Shower Presentation Engine</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="node_modules/@shower/ribbon/styles/styles.css">
    <link rel="stylesheet" href="./styles/main.css">
    <style>
        .shower {
            --slide-ratio: calc(16 / 9);
        }
    </style>
</head>
<body class="shower list">

    <header class="caption">
        <h1>Shower Presentation Engine</h1>
        <p>Yours Truly, Famous Inc.</p>
    </header>

    <section class="slide">
        <img class="cover" src="./images/offline-by-heart.png" alt="Offline by heart">
    </section>

    <section class="slide">
        <h2>Who am I?</h2>
        <div class="who-am-i" data-name="who-am-i">
            <img class="who-am-i__image" src="./images/stas-dolgachov.jpg" alt="Speaker image">
            <ul class="who-am-i__content">
                <li>Senior Software Engineer</li>
                <li>Play saxophone</li>
                <li>The Head of BEM police on the project</li>
            </ul>
        </div>
    </section>

    <section class="slide" data-name="what?">
        <h2 class="shout">What?</h2>
    </section>

    <section class="slide black">
        <img src="./images/meduza-offline.jpg" alt="Meduza app in offline mode">
    </section>

    <section class="slide" data-name="why-offline">
        <h2 class="shout">Why?</h2>
    </section>

    <section class="slide">
        <h2 class="shout">1. Devices</h2>
    </section>

    <section class="slide" data-name="iPhone 6">
        <img class="cover" src="./images/iphone-6.jpg" alt="Iphone 6 from 2014">

        <p class="next main-text"><b>2014...</b></p>
    </section>

    <section class="slide" data-name="metro law">
        <h2>
            <div>2. Murphy</div>
            <div>(Metro)</div>
            <div>law</div>
        </h2>
        <img class="cover" src="./images/metro-kyiv.jpg" alt="Kyiv metro map">
    </section>
    
    <section class="slide" data-name="but...">
        <h2 class="shout">But...</h2>
    </section>

    <section class="slide" data-name="Our project">
        <h2 class="shout">Our project</h2>
    </section>

    <section class="slide" data-name="tech specs">
        <h2>Tech. specs</h2>
         <ul>
             <li class="next"><h3>Cordova</h3></li>
             <li class="next"><h3>iOS only</h3></li>
             <li class="next"><h3>Angular+</h3></li>
             <li class="next"><h3>Ionic</h3></li>
         </ul>
    </section>

    <section class="slide" data-name="Dmytro & Stan">
        <img class="cover" src="./images/offline-developers.png" alt="Dmytro and Stan picture before starting the project">
    </section>

    <section class="slide grid black" data-name="Business requirements">
        <h2 class="white-text">
            <div>Our</div>
            <div>app</div>
        </h2>
        <img class="cover" src="./images/prism-app-2.png" alt="Google drive folders and files screen shot">
    </section>

    <section class="slide" data-name="Offline requirements">
        <h2>Offline requirements</h2>
        <ul>
            <li>Save</li>
            <li>Preview</li>
            <li>Delete</li>
        </ul>
    </section>

    <section class="slide" data-name="what could go wrong">
        <h2>What could possible go wrong?</h2>
        <img src="./images/what-could-possibly-go-wrong-gif.gif" alt="What could possible go wrong?">
    </section>

    <section class="slide" data-name="Life finds the way">
        <img class="place" src="./images/life-finds-the-way.gif" alt="Life finds the way">
    </section>

    <section class="slide" data-name="File + Metadata">
        <img class="place" src="./images/File%20and%20metadata.svg" alt="File + Metadata diagram">
    </section>

    <section class="slide">
        <h2 class="shout">1. File</h2>
    </section>

    <section class="slide">
        <h2>Cordova plugin for files</h2>
        <img src="./images/cordova-plugin.png" alt="Cordova plugin">
    </section>

    <section class="slide grid" data-name="File representation">
        <h2>1. File</h2>
        <img class="cover next" src="./images/box.png" alt="Box com logo">
    </section>

    <section class="slide" data-name="Dmytro's Golysh pull request">
        <img class="cover" src="./images/offline-pull-request.png" alt="Dmytro's Golysh pull request to Box content preview">
    </section>

    <section class="slide">
        <h2 class="shout">File âœ…</h2>
    </section>

    <section class="slide">
        <h2 class="shout">2. Metadata</h2>
    </section>

    <section class="slide">
        <h2>Cordova plugin for SQLite DB</h2>
        <img src="./images/cordova-plugin.png" alt="Cordova plugin">
    </section>

    <section class="slide grid" data-name="Redux + NgRx">
        <h2>Metadata</h2>
        <img class="next" src="./images/redux-logo.png" alt="Redux logo">
        <img class="next" src="./images/ngrx.png" alt="NgRx logo">
    </section>

    <section class="slide" data-name="Store responses">
        <h2>ðŸ’¡ Metadata</h2>
        <div class="columns two">
            <img class="next" src="./images/pwa.png" alt="PWA">
            <ol>
                <li class="next">Store in memory all responses</li>
                <li class="next">When user saves file => save required responses to <span class="mark-important">DataBase</span></li>
            </ol>
        </div>
    </section>

    <section class="slide" data-name="Store responses">
        <h2>ðŸ’¡ Metadata</h2>
        <div class="columns two">
            <div>
                <h3>Url: <mark>/folders</mark>  <mark class="mark-important next">KEY</mark></h3>
                <h3>Response:   <mark  class="mark-important next">VALUE</mark></h3>
                <pre class="main-text">
            [<img width="50" height="50" src="./images/dog.png" alt="dog">, <img width="50" height="50" src="./images/dog.png" alt="dog">, <img width="50" height="50" src="./images/dog.png" alt="dog">]
            </pre>
            </div>
        </div>
    </section>
    
    <section class="slide" data-name="Changes">
        <div class="next">
            <h3>Before</h3>
            <pre>
                <code><mark class="important">this.http.get(...)</mark></code>
            </pre>
        </div>

        <div class="next">
            <h3>After</h3>
            <pre>
                <code><mark>this.pcsHttp.get(...)</mark></code>
            </pre>
        </div>

        <img class="place right" src="./images/rocky.gif" alt="Rocky Balboa training session">

    </section>

    <section class="slide" data-name="First iteration success">
        <h2>Success!</h2>
        <img class="cover" src="./images/stark-bow.gif" alt="Tony Stark stays on stage">
    </section>

    <section class="slide" data-name="How long?">
        <h2 class="shout">How long?</h2>
    </section>

    <section class="slide" data-name="4 days">
        <h2 class="shout">~4 days</h2>
    </section>

    <section class="slide" data-name="Genius idea retro">
        <h2>Retro</h2>

        <div class="columns two">
            <div>
                <h3><span class="success-highlight">Advantages</span></h3>
                <ol>
                    <li class="next">Components "don't know" anything about offline</li>
                </ol>
            </div>

            <div>
                <h3 class="alert-highlight">Disadvantages</h3>
                <ol>
                    <li class="next">API changes very often</li>
                    <li class="next">Totally unclear what calls you need to save</li>
                </ol>
            </div>
        </div>
    </section>

    <section class="slide" data-name="iteration number two">
        <h2 class="shout">Iteration #2</h2>
    </section>

    <section class="slide" data-name="1. Several base stores">
        <h2>1. Several base stores</h2>
        <ul>
            <li><h4>Store data with no links to BE calls</h4></li>
            <li class="next"><h4>Cache in memory all requested data</h4></li>
            <li class="next"><h4>Store data in collections</h4></li>
        </ul>
    </section>

    <section class="slide" data-name="Collections">
        <h2>Companies store example</h2>

        <table class="striped">
            <tr>
                <th>Id</th>
                <th>Name</th>
                <th>firmParticipantId</th>
                <th>newDocumentsCount</th>
            </tr>

            <tr scope="row">
                <td>777</td>
                <th>ACME</th>
                <td>888</td>
                <td>10</td>
            </tr>

            <tr scope="row">
                <td>968</td>
                <th>ZAZ</th>
                <td>963</td>
                <td>0</td>
            </tr>

            <tr scope="row">
                <td>111</td>
                <th>KIA</th>
                <td>222</td>
                <td>22</td>
            </tr>

            <tr scope="row">
                <td>7555</td>
                <th>Jeep</th>
                <td>1213</td>
                <td>11</td>
            </tr>

            <tr scope="row">
                <td>14141</td>
                <th>Ford Co.</th>
                <td>33</td>
                <td>1</td>
            </tr>

        </table>
    </section>

    <section class="slide">
        <h2 class="shout">Outdated data</h2>
    </section>

    <section class="slide" data-name="Migrations">
        <h2>2. Migrations</h2>
        <img class="cover" src="./images/migration-dia.svg" alt="Migration scripts diagram">
    </section>

    <section class="slide" data-name="Synchronization">
        <h2>3. Synchronization</h2>
        <h3 class="next">NgRx effects</h3>
        <img class="cover next" src="./images/effects.svg" alt="Effects for synchronization">
    </section>

    <section class="slide" data-name="Synchronization">
        <h2>3. Synchronization</h2>
        <pre>
            <code><mark>@Effect({ dispatch: false })</mark></code>
            <code>public syncData: Observable<Action> = this.actions$.pipe(</code>
            <code>  <mark>ofType('SYNC_DATA'),</mark></code>
            <code>  tap((action) => {</code>
            <code>    <mark class="important">this.dataSyncService.sync(action.payload);</mark></code>
            <code>  })</code>
            <code>);</code>
        </pre>
    </section>

    <section class="slide">
        <h2>4. Deferred error logging</h2>
        <img class="cover" src="./images/error-handling.svg" alt="error handling">
    </section>

    <section class="slide" data-name="Tips & tricks">
        <h2 class="shout">
            Tips & tricks <img width="120" height="120" src="./images/dog.png" alt="dog">
        </h2>
    </section>

    <section class="slide">
        <h2>1. Offline is hard</h2>
        <div>
            <img src="./images/offline-is-hard.gif" alt="Dog falls down">
        </div>
    </section>

    <section class="slide">
        <h2>2. Auth when offline</h2>
        <div>
            <img src="./images/authozitaion.gif" alt="Dog falls down">
        </div>
    </section>

    <section class="slide">
        <h2>3. Deferred actions handling</h2>
        <div>
            <img src="./images/deferred-actions.gif" alt="Dog falls down">
        </div>
    </section>

    <section class="slide">
        <h2>4. Display proper UI for offline</h2>
        <div>
            <img src="./images/notify-user.gif" alt="Dog falls down">
        </div>
    </section>

    <section class="slide">
        <h2>5. Dynamic Cache</h2>
        <div>
            <img src="./images/dynamic-cache.gif" alt="Dog falls down">
        </div>
    </section>

    <section class="slide" data-name="on-more-thing">
        <img class="cover" src="./images/one_more_thing.png" alt="One more thing">
    </section>

    <section class="slide" data-name="the present">
        <h2>The present</h2>
        <img class="cover" src="./images/pwa.png" alt="PWA">
    </section>

    <section class="slide" data-name="the present">
        <img class="cover" src="./images/service-workers-support.png" alt="service-workers-support table">
    </section>

    <section class="slide black" data-name="the future">
        <h2>The future</h2>
        <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/File_and_Directory_Entries_API">
            File and Directory Entries API
        </a>
        <img  src="./images/matrix.gif" alt="Matrix">
    </section>

    <section class="slide">
        <h2>Links</h2>
        <ol>
            <li><a target="_blank" href="http://apandichi.github.io/database-migrations-in-cordova/">Database migrations in Cordova</a></li>
            <li><a target="_blank" href="https://blog.bradleygore.com/2015/09/25/cordova-sqlite-migrations/">Cordova Sqlite Migrations</a></li>
            <li><a target="_blank" href="https://habr.com/en/post/439238/">PWA in Google Store RUS</a></li>
            <li><a target="_blank" href="https://medium.com/@firt/google-play-store-now-open-for-progressive-web-apps-ec6f3c6ff3cc">PWA in Google Store EN</a></li>
            <li><a target="_blank" href="https://m.oursky.com/why-every-app-should-go-offline-first-53d4570963bf">Why every app should go offline-first</a></li>
        </ol>
    </section>

    <section class="slide">
        <h2 class="shout">Q&A</h2>
    </section>

    <footer class="badge">
        <a href="https://github.com/shower/shower">Fork me on GitHub</a>
    </footer>

    <div class="progress"></div>

    <script src="node_modules/shower-core/shower.min.js"></script>
    <!-- Copyright Â© 2019 Yours Truly, Famous Inc. -->

</body>
</html>
